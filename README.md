# 白泽 3.0

JARVIS级AI助手 - Node.js/TypeScript实现

联系我：baizehub@163.com

## 特性

- 🧠 **六阶段思考协议**: 理解→拆解→规划→调度→验收→反思
- 🔄 **主动任务机制**: 时间触发、事件触发、条件触发
- 📚 **三层记忆系统**: 情景记忆、声明式记忆、程序性记忆
- 🛠️ **可扩展技能系统**: 插件式技能架构
- 🤖 **多LLM支持**: 阿里云百炼、智谱清言、Ollama
- 🔒 **安全边界设计**: 四级风险确认机制
- 🧬 **自进化能力**: 角色化思考、安全沙箱

## 架构

```
┌─────────────────────────────────────────────────────────────────┐
│                    白泽3.0 架构                                   │
├─────────────────────────────────────────────────────────────────┤
│  L9 交互层      CLI / API                                        │
│  L8 安全层      认证 / 权限 / 审计                                │
│  L7 决策层      思考引擎 / 确认策略                                │
│  L6 调度层      任务调度器 / 主动任务                              │
│  L5 执行层      并行执行器                                        │
│  L4 能力层      技能注册表 / 技能加载器                            │
│  L3 知识层      向量存储 / RAG                                    │
│  L2 数据层      SQLite (sql.js)                                  │
│  L1 可观测层    日志 / 指标 / 追踪                                │
│                                                                 │
│  独立模块: 自进化系统                                             │
└─────────────────────────────────────────────────────────────────┘
```

## 快速开始

### 安装依赖

```bash
npm install
```

### 配置

复制环境变量模板：

```bash
cp .env.example .env
```

编辑 `.env` 文件，填入你的API Key：

```
ALIYUN_API_KEY=your_api_key
ZHIPU_API_KEY=your_api_key
```

### 启动

```bash
# 编译
npm run build

# 启动交互模式
npm start

# 或直接运行
node dist/cli/index.js start
```

## 支持的LLM

| 提供商 | 类型 | 配置 |
|--------|------|------|
| 阿里云百炼 | OpenAI兼容 | ALIYUN_API_KEY |
| 智谱清言 | OpenAI兼容 | ZHIPU_API_KEY |
| Ollama | 本地 | 无需Key |

## 项目结构

```
src/
├── cli/               # CLI入口
├── core/              # 核心层
│   ├── thinking/      # 思考引擎（六阶段）
│   ├── confirmation/  # 确认策略
│   └── error.ts       # 错误处理
├── llm/               # LLM适配器
│   ├── base.ts        # 基类
│   ├── index.ts       # 管理器
│   └── providers/     # 提供商实现
├── memory/            # 记忆系统
│   ├── database.ts    # SQLite数据库
│   └── index.ts       # 三层记忆
├── skills/            # 技能系统
│   ├── base.ts        # 技能基类
│   ├── registry.ts    # 技能注册表
│   └── builtin/       # 内置技能
├── scheduler/         # 调度层
│   ├── index.ts       # 任务调度器
│   └── proactive.ts   # 主动任务
├── executor/          # 执行层
├── evolution/         # 自进化模块
├── observability/     # 可观测层
├── types/             # 类型定义
└── index.ts           # 主入口
```

## 核心功能

### 六阶段思考协议

1. **理解**: 解析用户意图，提取核心需求
2. **拆解**: 将复杂任务分解为原子任务
3. **规划**: 选择技能，制定执行计划
4. **调度**: 安排执行顺序，管理并行组
5. **验收**: 检查执行结果，收集问题
6. **反思**: 分析失败原因，提出改进方案

### 三层记忆系统

- **情景记忆**: 对话历史、事件记录
- **声明式记忆**: 用户偏好、事实知识
- **程序性记忆**: 任务模式、执行流程

### 自进化系统

- 角色化思考（产品经理、开发者、测试、用户）
- 安全沙箱机制
- 权限分级管理

## 开发

```bash
# 开发模式
npm run dev

# 构建
npm run build

# 测试
npm test
```

## 许可证

MIT
